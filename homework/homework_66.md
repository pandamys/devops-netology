# Задача 1
Я бы запустил команду для поиска операций, которые выполняются больше 3 минут
```doctest
db.currentOp(
   {
     "active" : true,
     "secs_running" : { "$gt" : 180 },
     "ns" : /^db1\./
   }
)
```
Выяснив ID операции, можно было бы её остановить следующей командой
```doctest
db.killOp(11111)
```
Для решения проблемы с долгими запросами можно ограничить время выполнения запросов через файл конфигурации
```doctest
operationProfiling:
  slowOpThresholdMs: 50
```

# Задача 2
Если я правильно понял, то дело в механизме очистки ключей, которые истекли, по умолчанию удаляет по 200 записей в секунду (ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP). Поэтому Redis не успевает очистить базу и начинает тормозить.
В случае проблем можно использовать команду для включения мониторинга задержек.

Очищаться ключи начинают двумя способами:
- лениво, когда команда запрашивает ключ и оказывается, что ключ уже истёк;
- активно, каждые 100 секунд истекают несколько ключей, если ключей больше 25% истекло, то он повторяется;

```doctest
CONFIG SET latency-monitor-threshold 100
```
или
```doctest
CONFIG SET watchdog-period 500
```

# Задача 3
Если я правильно понимаю, то проблема заключается в запросе, который передаёт множество строк в запросе и надо увеличить параметр
```doctest
net_read_timeout
```
Либо проблема в соединение к серверу и надо увеличить таймаут
```doctest
connect_timeout
```

# Задача 4
oom - говорит нам, что происходит Out Of Memory или то, что кончается память и запускается процесс её очистки.
В данном случае необходимо расширить доступную память для postgres.

Почитав в интернете, нашёл, что можно:
- грамотно настроить выделенную память под постгрес;
- можно нужному процессу задать - oom_score_adj, тогда при расчёте OOM-killer будет пропускать наш процесс;
- изменить способ резервации памяти (vm.overcommit_memory, значение 2), чтобы система не резервировала памяти под процессы больше, чем есть.
- отключить совсем OOM-killer (плохой вариант);